function chaoByteToChar(b: number): string | null {
  switch (b) {
    case 0x01: return '!';
    case 0x02: return '\"';
    case 0x03: return '#';
    case 0x04: return '$';
    case 0x05: return '%';
    case 0x06: return '&';
    case 0x07: return '\\';
    case 0x08: return '(';
    case 0x09: return ')';
    case 0x0A: return '*';
    case 0x0B: return '+';
    case 0x0C: return ',';
    case 0x0D: return '-';
    case 0x0E: return '.';
    case 0x0F: return '/';
    case 0x10: return '0';
    case 0x11: return '1';
    case 0x12: return '2';
    case 0x13: return '3';
    case 0x14: return '4';
    case 0x15: return '5';
    case 0x16: return '6';
    case 0x17: return '7';
    case 0x18: return '8';
    case 0x19: return '9';
    case 0x1A: return ':';
    case 0x1B: return ';';
    case 0x1C: return '<';
    case 0x1D: return '=';
    case 0x1E: return '>';
    case 0x1F: return '?';
    case 0x20: return '@';
    case 0x21: return 'A';
    case 0x22: return 'B';
    case 0x23: return 'C';
    case 0x24: return 'D';
    case 0x25: return 'E';
    case 0x26: return 'F';
    case 0x27: return 'G';
    case 0x28: return 'H';
    case 0x29: return 'I';
    case 0x2A: return 'J';
    case 0x2B: return 'K';
    case 0x2C: return 'L';
    case 0x2D: return 'M';
    case 0x2E: return 'N';
    case 0x2F: return 'O';
    case 0x30: return 'P';
    case 0x31: return 'Q';
    case 0x32: return 'R';
    case 0x33: return 'S';
    case 0x34: return 'T';
    case 0x35: return 'U';
    case 0x36: return 'V';
    case 0x37: return 'W';
    case 0x38: return 'X';
    case 0x39: return 'Y';
    case 0x3A: return 'Z';
    case 0x3B: return '[';
    case 0x3C: return '¥';
    case 0x3D: return ']';
    case 0x3E: return '^';
    case 0x3F: return '_';
    case 0x40: return '‘';
    case 0x41: return 'a';
    case 0x42: return 'b';
    case 0x43: return 'c';
    case 0x44: return 'd';
    case 0x45: return 'e';
    case 0x46: return 'f';
    case 0x47: return 'g';
    case 0x48: return 'h';
    case 0x49: return 'i';
    case 0x4A: return 'j';
    case 0x4B: return 'k';
    case 0x4C: return 'l';
    case 0x4D: return 'm';
    case 0x4E: return 'n';
    case 0x4F: return 'o';
    case 0x50: return 'p';
    case 0x51: return 'q';
    case 0x52: return 'r';
    case 0x53: return 's';
    case 0x54: return 't';
    case 0x55: return 'u';
    case 0x56: return 'v';
    case 0x57: return 'w';
    case 0x58: return 'x';
    case 0x59: return 'y';
    case 0x5A: return 'z';
    case 0x5B: return '{';
    case 0x5C: return '|';
    case 0x5D: return '}';
    case 0x5E: return '~';
    case 0x5F: return ' ';
    case 0x60: return 'À';
    case 0x61: return 'Á';
    case 0x62: return 'Â';
    case 0x63: return 'Ã';
    case 0x64: return 'Ä';
    case 0x65: return 'Å';
    case 0x66: return 'Æ';
    case 0x67: return 'Ç';
    case 0x68: return 'È';
    case 0x69: return 'É';
    case 0x6A: return 'Ê';
    case 0x6B: return 'Ë';
    case 0x6C: return 'Ì';
    case 0x6D: return 'Í';
    case 0x6E: return 'Î';
    case 0x6F: return 'Ï';
    case 0x70: return 'Ð';
    case 0x71: return 'Ñ';
    case 0x72: return 'Ò';
    case 0x73: return 'Ó';
    case 0x74: return 'Ô';
    case 0x75: return 'Õ';
    case 0x76: return 'Ö';
    case 0x77: return '¿';
    case 0x78: return 'Ø';
    case 0x79: return 'Ù';
    case 0x7A: return 'Ú';
    case 0x7B: return 'Û';
    case 0x7C: return 'Ü';
    case 0x7D: return 'Ý';
    case 0x7E: return 'Þ';
    case 0x7F: return 'ß';
    case 0x80: return 'à';
    case 0x81: return 'á';
    case 0x82: return 'â';
    case 0x83: return 'ã';
    case 0x84: return 'ä';
    case 0x85: return 'å';
    case 0x86: return 'æ';
    case 0x87: return 'ç';
    case 0x88: return 'è';
    case 0x89: return 'é';
    case 0x8A: return 'ê';
    case 0x8B: return 'ë';
    case 0x8C: return 'ì';
    case 0x8D: return 'í';
    case 0x8E: return 'î';
    case 0x8F: return 'ï';
    case 0x90: return 'ð';
    case 0x91: return 'ñ';
    case 0x92: return 'ò';
    case 0x93: return 'ó';
    case 0x94: return 'ô';
    case 0x95: return 'õ';
    case 0x96: return 'ö';
    case 0x97: return '¡';
    case 0x98: return 'ø';
    case 0x99: return 'ù';
    case 0x9A: return 'ú';
    case 0x9B: return 'û';
    case 0x9C: return 'ü';
    case 0x9D: return 'ý';
    case 0x9E: return 'þ';
    case 0x9F: return 'ÿ';
    case 0xA0: return 'ァ';
    case 0xA1: return 'ア';
    case 0xA2: return 'ィ';
    case 0xA3: return 'イ';
    case 0xA4: return 'ゥ';
    case 0xA5: return 'ウ';
    case 0xA6: return 'ェ';
    case 0xA7: return 'エ';
    case 0xA8: return 'ォ';
    case 0xA9: return 'オ';
    case 0xAA: return 'カ';
    case 0xAB: return 'ガ';
    case 0xAC: return 'キ';
    case 0xAD: return 'ギ';
    case 0xAE: return 'ク';
    case 0xAF: return 'グ';
    case 0xB0: return 'ケ';
    case 0xB1: return 'ゲ';
    case 0xB2: return 'コ';
    case 0xB3: return 'ゴ';
    case 0xB4: return 'サ';
    case 0xB5: return 'ザ';
    case 0xB6: return 'シ';
    case 0xB7: return 'ジ';
    case 0xB8: return 'ス';
    case 0xB9: return 'ズ';
    case 0xBA: return 'セ';
    case 0xBB: return 'ゼ';
    case 0xBC: return 'ソ';
    case 0xBD: return 'ゾ';
    case 0xBE: return 'タ';
    case 0xBF: return 'ダ';
    case 0xC0: return 'チ';
    case 0xC1: return 'ヂ';
    case 0xC2: return 'ツ';
    case 0xC3: return 'ッ';
    case 0xC4: return 'ヅ';
    case 0xC5: return 'テ';
    case 0xC6: return 'デ';
    case 0xC7: return 'ト';
    case 0xC8: return 'ド';
    case 0xC9: return 'ナ';
    case 0xCA: return 'ニ';
    case 0xCB: return 'ヌ';
    case 0xCC: return 'ネ';
    case 0xCD: return 'ノ';
    case 0xCE: return 'ハ';
    case 0xCF: return 'バ';
    case 0xD0: return 'パ';
    case 0xD1: return 'ヒ';
    case 0xD2: return 'ビ';
    case 0xD3: return 'ピ';
    case 0xD4: return 'フ';
    case 0xD5: return 'ブ';
    case 0xD6: return 'プ';
    case 0xD7: return 'ヘ';
    case 0xD8: return 'ベ';
    case 0xD9: return 'ペ';
    case 0xDA: return 'ホ';
    case 0xDB: return 'ボ';
    case 0xDC: return 'ポ';
    case 0xDD: return 'マ';
    case 0xDE: return 'ミ';
    case 0xDF: return 'ム';
    case 0xE0: return 'メ';
    case 0xE1: return 'モ';
    case 0xE2: return 'ャ';
    case 0xE3: return 'ヤ';
    case 0xE4: return 'ュ';
    case 0xE5: return 'ユ';
    case 0xE6: return 'ョ';
    case 0xE7: return 'ヨ';
    case 0xE8: return 'ラ';
    case 0xE9: return 'リ';
    case 0xEA: return 'ル';
    case 0xEB: return 'レ';
    case 0xEC: return 'ロ';
    case 0xED: return 'ヮ';
    case 0xEE: return 'ワ';
    case 0xEF: return 'ﾞ';
    case 0xF0: return 'ﾟ';
    case 0xF1: return 'ヲ';
    case 0xF2: return 'ン';
    case 0xF3: return '。';
    case 0xF4: return '、';
    case 0xF5: return '〒';
    case 0xF6: return '・';
    case 0xF7: return '★';
    case 0xF8: return '♀';
    case 0xF9: return '♂';
    case 0xFA: return '♪';
    case 0xFB: return '…';
    case 0xFC: return '「';
    case 0xFD: return '」';
    case 0xFE: return 'ヴ';
    default: return null;
  }
}

function chaoCharToByte(s: string): number | null {
  switch (s) {
    case '!': return 0x01;
    case '\"': return 0x02;
    case '#': return 0x03;
    case '$': return 0x04;
    case '%': return 0x05;
    case '&': return 0x06;
    case '\\': return 0x07;
    case '(': return 0x08;
    case ')': return 0x09;
    case '*': return 0x0A;
    case '+': return 0x0B;
    case ',': return 0x0C;
    case '-': return 0x0D;
    case '.': return 0x0E;
    case '/': return 0x0F;
    case '0': return 0x10;
    case '1': return 0x11;
    case '2': return 0x12;
    case '3': return 0x13;
    case '4': return 0x14;
    case '5': return 0x15;
    case '6': return 0x16;
    case '7': return 0x17;
    case '8': return 0x18;
    case '9': return 0x19;
    case ':': return 0x1A;
    case ';': return 0x1B;
    case '<': return 0x1C;
    case '=': return 0x1D;
    case '>': return 0x1E;
    case '?': return 0x1F;
    case '@': return 0x20;
    case 'A': return 0x21;
    case 'B': return 0x22;
    case 'C': return 0x23;
    case 'D': return 0x24;
    case 'E': return 0x25;
    case 'F': return 0x26;
    case 'G': return 0x27;
    case 'H': return 0x28;
    case 'I': return 0x29;
    case 'J': return 0x2A;
    case 'K': return 0x2B;
    case 'L': return 0x2C;
    case 'M': return 0x2D;
    case 'N': return 0x2E;
    case 'O': return 0x2F;
    case 'P': return 0x30;
    case 'Q': return 0x31;
    case 'R': return 0x32;
    case 'S': return 0x33;
    case 'T': return 0x34;
    case 'U': return 0x35;
    case 'V': return 0x36;
    case 'W': return 0x37;
    case 'X': return 0x38;
    case 'Y': return 0x39;
    case 'Z': return 0x3A;
    case '[': return 0x3B;
    case '¥': return 0x3C;
    case ']': return 0x3D;
    case '^': return 0x3E;
    case '_': return 0x3F;
    case '‘': return 0x40;
    case 'a': return 0x41;
    case 'b': return 0x42;
    case 'c': return 0x43;
    case 'd': return 0x44;
    case 'e': return 0x45;
    case 'f': return 0x46;
    case 'g': return 0x47;
    case 'h': return 0x48;
    case 'i': return 0x49;
    case 'j': return 0x4A;
    case 'k': return 0x4B;
    case 'l': return 0x4C;
    case 'm': return 0x4D;
    case 'n': return 0x4E;
    case 'o': return 0x4F;
    case 'p': return 0x50;
    case 'q': return 0x51;
    case 'r': return 0x52;
    case 's': return 0x53;
    case 't': return 0x54;
    case 'u': return 0x55;
    case 'v': return 0x56;
    case 'w': return 0x57;
    case 'x': return 0x58;
    case 'y': return 0x59;
    case 'z': return 0x5A;
    case '{': return 0x5B;
    case '|': return 0x5C;
    case '}': return 0x5D;
    case '~': return 0x5E;
    case ' ': return 0x5F;
    case 'À': return 0x60;
    case 'Á': return 0x61;
    case 'Â': return 0x62;
    case 'Ã': return 0x63;
    case 'Ä': return 0x64;
    case 'Å': return 0x65;
    case 'Æ': return 0x66;
    case 'Ç': return 0x67;
    case 'È': return 0x68;
    case 'É': return 0x69;
    case 'Ê': return 0x6A;
    case 'Ë': return 0x6B;
    case 'Ì': return 0x6C;
    case 'Í': return 0x6D;
    case 'Î': return 0x6E;
    case 'Ï': return 0x6F;
    case 'Ð': return 0x70;
    case 'Ñ': return 0x71;
    case 'Ò': return 0x72;
    case 'Ó': return 0x73;
    case 'Ô': return 0x74;
    case 'Õ': return 0x75;
    case 'Ö': return 0x76;
    case '¿': return 0x77;
    case 'Ø': return 0x78;
    case 'Ù': return 0x79;
    case 'Ú': return 0x7A;
    case 'Û': return 0x7B;
    case 'Ü': return 0x7C;
    case 'Ý': return 0x7D;
    case 'Þ': return 0x7E;
    case 'ß': return 0x7F;
    case 'à': return 0x80;
    case 'á': return 0x81;
    case 'â': return 0x82;
    case 'ã': return 0x83;
    case 'ä': return 0x84;
    case 'å': return 0x85;
    case 'æ': return 0x86;
    case 'ç': return 0x87;
    case 'è': return 0x88;
    case 'é': return 0x89;
    case 'ê': return 0x8A;
    case 'ë': return 0x8B;
    case 'ì': return 0x8C;
    case 'í': return 0x8D;
    case 'î': return 0x8E;
    case 'ï': return 0x8F;
    case 'ð': return 0x90;
    case 'ñ': return 0x91;
    case 'ò': return 0x92;
    case 'ó': return 0x93;
    case 'ô': return 0x94;
    case 'õ': return 0x95;
    case 'ö': return 0x96;
    case '¡': return 0x97;
    case 'ø': return 0x98;
    case 'ù': return 0x99;
    case 'ú': return 0x9A;
    case 'û': return 0x9B;
    case 'ü': return 0x9C;
    case 'ý': return 0x9D;
    case 'þ': return 0x9E;
    case 'ÿ': return 0x9F;
    case 'ァ': return 0xA0;
    case 'ア': return 0xA1;
    case 'ィ': return 0xA2;
    case 'イ': return 0xA3;
    case 'ゥ': return 0xA4;
    case 'ウ': return 0xA5;
    case 'ェ': return 0xA6;
    case 'エ': return 0xA7;
    case 'ォ': return 0xA8;
    case 'オ': return 0xA9;
    case 'カ': return 0xAA;
    case 'ガ': return 0xAB;
    case 'キ': return 0xAC;
    case 'ギ': return 0xAD;
    case 'ク': return 0xAE;
    case 'グ': return 0xAF;
    case 'ケ': return 0xB0;
    case 'ゲ': return 0xB1;
    case 'コ': return 0xB2;
    case 'ゴ': return 0xB3;
    case 'サ': return 0xB4;
    case 'ザ': return 0xB5;
    case 'シ': return 0xB6;
    case 'ジ': return 0xB7;
    case 'ス': return 0xB8;
    case 'ズ': return 0xB9;
    case 'セ': return 0xBA;
    case 'ゼ': return 0xBB;
    case 'ソ': return 0xBC;
    case 'ゾ': return 0xBD;
    case 'タ': return 0xBE;
    case 'ダ': return 0xBF;
    case 'チ': return 0xC0;
    case 'ヂ': return 0xC1;
    case 'ツ': return 0xC2;
    case 'ッ': return 0xC3;
    case 'ヅ': return 0xC4;
    case 'テ': return 0xC5;
    case 'デ': return 0xC6;
    case 'ト': return 0xC7;
    case 'ド': return 0xC8;
    case 'ナ': return 0xC9;
    case 'ニ': return 0xCA;
    case 'ヌ': return 0xCB;
    case 'ネ': return 0xCC;
    case 'ノ': return 0xCD;
    case 'ハ': return 0xCE;
    case 'バ': return 0xCF;
    case 'パ': return 0xD0;
    case 'ヒ': return 0xD1;
    case 'ビ': return 0xD2;
    case 'ピ': return 0xD3;
    case 'フ': return 0xD4;
    case 'ブ': return 0xD5;
    case 'プ': return 0xD6;
    case 'ヘ': return 0xD7;
    case 'ベ': return 0xD8;
    case 'ペ': return 0xD9;
    case 'ホ': return 0xDA;
    case 'ボ': return 0xDB;
    case 'ポ': return 0xDC;
    case 'マ': return 0xDD;
    case 'ミ': return 0xDE;
    case 'ム': return 0xDF;
    case 'メ': return 0xE0;
    case 'モ': return 0xE1;
    case 'ャ': return 0xE2;
    case 'ヤ': return 0xE3;
    case 'ュ': return 0xE4;
    case 'ユ': return 0xE5;
    case 'ョ': return 0xE6;
    case 'ヨ': return 0xE7;
    case 'ラ': return 0xE8;
    case 'リ': return 0xE9;
    case 'ル': return 0xEA;
    case 'レ': return 0xEB;
    case 'ロ': return 0xEC;
    case 'ヮ': return 0xED;
    case 'ワ': return 0xEE;
    case 'ﾞ': return 0xEF;
    case 'ﾟ': return 0xF0;
    case 'ヲ': return 0xF1;
    case 'ン': return 0xF2;
    case '。': return 0xF3;
    case '、': return 0xF4;
    case '〒': return 0xF5;
    case '・': return 0xF6;
    case '★': return 0xF7;
    case '♀': return 0xF8;
    case '♂': return 0xF9;
    case '♪': return 0xFA;
    case '…': return 0xFB;
    case '「': return 0xFC;
    case '」': return 0xFD;
    case 'ヴ': return 0xFE;
    default: return null;
  }
}

export function chaoBytesToString(bytes: number[]): string {
  return bytes.map(chaoByteToChar).filter(char => char !== null).join('');
}

export function chaoStringToBytes(str: string): number[] {
  let trimmedString = str.substring(0, 7)
  let byteArray = new Array(7).fill(0)
  for (let i = 0; i < trimmedString.length; i++) {
    let byte = chaoCharToByte(trimmedString[i])
    byteArray[i] = byte !== null ? byte : 0x3F
  }
  return byteArray;
}
